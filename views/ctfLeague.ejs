
<%- include("header.ejs", {
    "mode": "ctfleague", 
    meta,
    host,
    userSession
    }) -%>


<script src="../js/ui/ui.js"></script>
<script src="../js/ui/ctfLeague.js"></script>

<div class="header-wrapper">CTF League</div>
<div id="tabs"></div>
<script>
    renderTypeTabs("#tabs", "<%= mode %>");
</script>
<div id="root">

    <div class="info">
        
        <b>3 points</b> if the player is on the winning team, <b>1 point</b> for a tie, and <b>0 points</b> for a loss.
        <br>
        <% 

        let leagueType = "Unknown";

        if(mode === "gametypes") leagueType = "Gametype";
        if(mode === "maps") leagueType = "Map";
        if(mode === "combined") leagueType = "Combined(Any CTF Gametype and Map combination)";

        if(maxMatchAge != 0){
            %>
                Only matches played in the previous <b><%= maxMatchAge %> days</b> are counted towards a league.<br>
            <%
        }

        if(maxMatchesPerPlayer != 0){
            %>
                Players have a maximum of <b><%= maxMatchesPerPlayer %> matches</b> counted towards a league, only their most recent will be counted if they play more.<br>
            <%
        }

        %>
    </div>
</div>
<div class="info">
    Last whole <b><%= leagueType %></b> League refresh was <b><%= lastLeagueRefresh %></b><br/>
    All leagues are refreshed once every 24 hours to remove players and matches outside the specified time frame, 
    and every time a match with the same gametype or map is imported.
    
</div>
<script>
    new CTFLeagueFilterForm("#root", "<%= mode %>", <%- JSON.stringify(gametypeNames) %>, <%- JSON.stringify(mapNames) %>, "<%= id %>", "<%= gId %>");
    new CTFLeagueTable("#root", "<%= mode %>", <%- JSON.stringify(data) %>,  "<%= id %>", "<%= gId %>", "<%= page %>", "<%= perPage %>", "<%= subHeader %>");
</script>

<%- include("footer.ejs") -%>